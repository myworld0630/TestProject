SELECT     CG.Name AS _customerName, S.IsEnable AS _enabled, CG.compID AS _customer_id, DD.Name + '_Action(LowTemperature)_' + CAST(S.ScheduleID AS varchar) 
                      AS _name, '1' AS _type, S.Year + ';' + S.Month + ';' + S.Day + ';' + S.WeekDay + ';' + S.Hour + ';' + S.Minute AS _cron, DD.DeviceID AS _device_id, 
                      S.Action AS _tag_name, S.LowTemperature AS _tag_value, S.ProfileID AS _schedule_backup_id, SP.ProfileName AS _schedule_backup_name, 
                      SP.ProfileDescription AS _schedule_backup_desc
FROM         UP_Schedule AS S INNER JOIN
                      UP_Device AS DD ON S.DeviceID = DD.DeviceID LEFT OUTER JOIN
                      UP_ScheduleProfile AS SP ON SP.ProfileID = S.ProfileID INNER JOIN
                      UP_ControlServer AS CS ON S.CSID = CS.CSID INNER JOIN
                      UP_CustomerGroup AS CG ON CS.CGID = CG.CGID
WHERE     (DD.DeviceID IN
                          (SELECT     DeviceID
                            FROM          UP_Device
                            WHERE      (CSID IN
                                                       (SELECT     CS.CSID
                                                         FROM          UP_CustomerGroup AS CG INNER JOIN
                                                                                UP_ControlServer AS CS ON CG.CGID = CS.CGID
                                                         WHERE      (CG.Name IS NOT NULL)))))
ORDER BY _customerName